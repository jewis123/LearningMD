<!DOCTYPE html>
<!-- saved from url=(0105)http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels -->
<html lang="en" dir="ltr" class="client-js"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Cellular Automata Method for Generating Random Cave-Like Levels - RogueBasin</title>

<meta name="generator" content="MediaWiki 1.19.9">
<link rel="shortcut icon" href="http://www.roguebasin.com/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="http://www.roguebasin.com/opensearch_desc.php" title="RogueBasin (en)">
<link rel="EditURI" type="application/rsd+xml" href="http://www.roguebasin.com/api.php?action=rsd">
<link rel="alternate" type="application/atom+xml" title="RogueBasin Atom feed" href="http://www.roguebasin.com/index.php?title=Special:RecentChanges&amp;feed=atom">
<link rel="stylesheet" href="./Cellular Automata Method for Generating Random Cave-Like Levels - RogueBasin_files/load.php">
<!--[if IE 6]><link rel="stylesheet" href="/skins/monobook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/skins/monobook/IE70Fixes.css?303" media="screen" /><![endif]--><style type="text/css" media="all">.js-messagebox{margin:1em 5%;padding:0.5em 2.5%;border:1px solid #ccc;background-color:#fcfcfc;font-size:0.8em}.js-messagebox .js-messagebox-group{margin:1px;padding:0.5em 2.5%;border-bottom:1px solid #ddd}.js-messagebox .js-messagebox-group:last-child{border-bottom:thin none transparent}

/* cache key: 133099-basin:resourceloader:filter:minify-css:7:8b08bdc91c52a9ffba396dccfb5b473c */


.mw-collapsible-toggle{float:right} li .mw-collapsible-toggle{float:none} .mw-collapsible-toggle-li{list-style:none}

/* cache key: 133099-basin:resourceloader:filter:minify-css:7:4250852ed2349a0d4d0fc6509a3e7d4c */
</style><meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="./Cellular Automata Method for Generating Random Cave-Like Levels - RogueBasin_files/load(1).php">
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}a.new,#quickbar a.new{color:#ba0000}

/* cache key: 133099-basin:resourceloader:filter:minify-css:7:c88e2bcd56513749bec09a7e29cb3ffa */
</style>

<script src="./Cellular Automata Method for Generating Random Cave-Like Levels - RogueBasin_files/load(2).php"></script><script src="./Cellular Automata Method for Generating Random Cave-Like Levels - RogueBasin_files/load(3).php"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels","wgTitle":"Cellular Automata Method for Generating Random Cave-Like Levels","wgCurRevisionId":43208,"wgArticleId":991,"wgIsArticle":true,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Articles","WorldGeneration","Maps"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgRelevantPageName":"Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels","wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":
0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;},{},{});mw.loader.implement("user.tokens",function($){mw.user.tokens.set({"editToken":"+\\","watchToken":false});;},{},{});

/* cache key: 133099-basin:resourceloader:filter:minify-js:7:74a832f2292f1f4d40d425d223444e78 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script><script type="text/javascript" src="./Cellular Automata Method for Generating Random Cave-Like Levels - RogueBasin_files/load(4).php"></script>
<style type="text/css">/*<![CDATA[*/
.source-c {line-height: normal;}
.source-c li, .source-c pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for c
 * CSS class: source-c, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.c.source-c .de1, .c.source-c .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;}
.c.source-c  {font-family:monospace;}
.c.source-c .imp {font-weight: bold; color: red;}
.c.source-c li, .c.source-c .li1 {font-weight: normal; vertical-align:top;}
.c.source-c .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.c.source-c .li2 {font-weight: bold; vertical-align:top;}
.c.source-c .kw1 {color: #b1b100;}
.c.source-c .kw2 {color: #000000; font-weight: bold;}
.c.source-c .kw3 {color: #000066;}
.c.source-c .kw4 {color: #993333;}
.c.source-c .co1 {color: #666666; font-style: italic;}
.c.source-c .co2 {color: #339933;}
.c.source-c .coMULTI {color: #808080; font-style: italic;}
.c.source-c .es0 {color: #000099; font-weight: bold;}
.c.source-c .es1 {color: #000099; font-weight: bold;}
.c.source-c .es2 {color: #660099; font-weight: bold;}
.c.source-c .es3 {color: #660099; font-weight: bold;}
.c.source-c .es4 {color: #660099; font-weight: bold;}
.c.source-c .es5 {color: #006699; font-weight: bold;}
.c.source-c .br0 {color: #009900;}
.c.source-c .sy0 {color: #339933;}
.c.source-c .st0 {color: #ff0000;}
.c.source-c .nu0 {color: #0000dd;}
.c.source-c .nu6 {color: #208080;}
.c.source-c .nu8 {color: #208080;}
.c.source-c .nu12 {color: #208080;}
.c.source-c .nu16 {color:#800080;}
.c.source-c .nu17 {color:#800080;}
.c.source-c .nu18 {color:#800080;}
.c.source-c .nu19 {color:#800080;}
.c.source-c .me1 {color: #202020;}
.c.source-c .me2 {color: #202020;}
.c.source-c .ln-xtra, .c.source-c li.ln-xtra, .c.source-c div.ln-xtra {background-color: #ffc;}
.c.source-c span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
/*]]>*/
</style><style type="text/css">/*<![CDATA[*/
.source-csharp {line-height: normal;}
.source-csharp li, .source-csharp pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for csharp
 * CSS class: source-csharp, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.csharp.source-csharp .de1, .csharp.source-csharp .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;}
.csharp.source-csharp  {font-family:monospace;}
.csharp.source-csharp .imp {font-weight: bold; color: red;}
.csharp.source-csharp li, .csharp.source-csharp .li1 {font-weight: normal; vertical-align:top;}
.csharp.source-csharp .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.csharp.source-csharp .li2 {font-weight: bold; vertical-align:top;}
.csharp.source-csharp .kw1 {color: #0600FF; font-weight: bold;}
.csharp.source-csharp .kw2 {color: #FF8000; font-weight: bold;}
.csharp.source-csharp .kw3 {color: #008000;}
.csharp.source-csharp .kw4 {color: #6666cc; font-weight: bold;}
.csharp.source-csharp .kw5 {color: #000000;}
.csharp.source-csharp .co1 {color: #008080; font-style: italic;}
.csharp.source-csharp .co2 {color: #008080;}
.csharp.source-csharp .co3 {color: #008080;}
.csharp.source-csharp .coMULTI {color: #008080; font-style: italic;}
.csharp.source-csharp .es0 {color: #008080; font-weight: bold;}
.csharp.source-csharp .es_h {color: #008080; font-weight: bold;}
.csharp.source-csharp .br0 {color: #008000;}
.csharp.source-csharp .sy0 {color: #008000;}
.csharp.source-csharp .st0 {color: #666666;}
.csharp.source-csharp .st_h {color: #666666;}
.csharp.source-csharp .nu0 {color: #FF0000;}
.csharp.source-csharp .me1 {color: #0000FF;}
.csharp.source-csharp .me2 {color: #0000FF;}
.csharp.source-csharp .ln-xtra, .csharp.source-csharp li.ln-xtra, .csharp.source-csharp div.ln-xtra {background-color: #ffc;}
.csharp.source-csharp span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
/*]]>*/
</style></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels skin-monobook action-view">
<div id="globalWrapper">
<div id="column-content"><div id="content"><div id="mw-js-message" class="js-messagebox" style="display: none;"></div>
	<a id="top"></a>
	<div id="siteNotice"><div id="localNotice" lang="en" dir="ltr"></div></div>
	<h1 id="firstHeading" class="firstHeading"><span dir="auto">Cellular Automata Method for Generating Random Cave-Like Levels</span></h1>
	<div id="bodyContent" class="mw-body">
		<div id="siteSub">From RogueBasin</div>
		<div id="contentSub"></div>
		<div id="jump-to-nav" class="mw-jump">Jump to: <a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#column-one">navigation</a>, <a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#searchInput">search</a></div>
		<!-- start content -->
<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table id="toc" class="toc"><tbody><tr><td><div id="toctitle"><h2>Contents</h2><span class="toctoggle">&nbsp;[<a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#" class="internal" id="togglelink">hide</a>]&nbsp;</span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#Advantages"><span class="tocnumber">2</span> <span class="toctext">Advantages</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#Disadvantages"><span class="tocnumber">3</span> <span class="toctext">Disadvantages</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#The_isolated_cave_problem"><span class="tocnumber">4</span> <span class="toctext">The isolated cave problem</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#Rule_Tweaking"><span class="tocnumber">4.1</span> <span class="toctext">Rule Tweaking</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#Flood_Fill"><span class="tocnumber">4.2</span> <span class="toctext">Flood Fill</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#Horizontal_Blanking"><span class="tocnumber">4.3</span> <span class="toctext">Horizontal Blanking</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#Example_Output"><span class="tocnumber">5</span> <span class="toctext">Example Output</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#Example_Code"><span class="tocnumber">6</span> <span class="toctext">Example Code</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#C_Code"><span class="tocnumber">6.1</span> <span class="toctext">C Code</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#C.23_Code"><span class="tocnumber">6.2</span> <span class="toctext">C# Code</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels#Implementations"><span class="tocnumber">7</span> <span class="toctext">Implementations</span></a></li>
</ul>
</td></tr></tbody></table>
<h2> <span class="mw-headline" id="Introduction"> Introduction </span></h2>
<p>It is an old and fairly well documented trick to use <a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/Cellular_automaton">cellular automata</a> to generate cave-like structures. The basic idea is to fill the first map randomly, then repeatedly create new maps using the 4-5 rule: a tile becomes a wall if it was a wall and 4 or more of its eight neighbors were walls, or if it was not a wall and 5 or more neighbors were. Put more succinctly, a tile is a wall if the 3x3 region centered on it contained at least 5 walls. Each iteration makes each tile more like its neighbors, and the amount of overall "noise" is gradually reduced:
</p>
<pre>original:           iteration 1:        2:                  3:                  4:
 #       ### ##     ####  ##########    ####  ##########    ####  ##########    ####  ##########
# ##  ## ## #       # #      ##### #    ###      #######    ###      #######    ###      #######
 # # ##   #### #    # #   #   #### #    ##        ######    ##        ######    ##        ######
 # #  #  # ## #     ###  #     ### #    ##         #####    ##         #####    ##         #####
### # #     # #     #    #     #####    ##         #####    ##         #####    ##        ######
    # # ## #####    ##     ###  ####    #       ## #####    ##      ########    ##      ########
##     ####  #      #      #### ####    ##     ####  ###    ##     #### ####    ##     #########
## ## # ## #  ##    ###    ####    #    ###    ###   ###    ###    ####  ###    ###    #########
# ##  ###  #  #     ##### ###    ###    ####  #####  ###    ####  ##### ####    ####   #########
#  # # #  # ###     # ### ##########    ###### #########    #####  #########    ####   #########
  ## ## #### # #    #####    #######    ####    ########    ####    ########    ####    ########
####    # # # #     # #      #######    ##        ######    ##       #######    ##       #######
       #   ## ##    #          #####    #         ######    #         ######    #         ######
   # #    # ####               #####    #         ######    #         ######    #         ######
# # #  ## ######    #        #######    #        #######    ##       #######    ##       #######
#  #  # ####  #     ################    ################    ################    ################
</pre>
<p>If 45% of the original random map contains walls and the process is repeated 5 times, the output might look like the following:
</p>
<pre>############################################################
###....####################################.....############
##......######################..#########.........##########
##......#####################....#######...........####.####
##......###################.........................##...###
##......##################..........................###...##
#........##############.............................###...##
#........#############...............................#....##
##.......##############..................................###
##.......###..############..............................####
##.......##....############.............................####
#..............############...###........................###
#...............###########..#####...............##.......##
#................#################...............##.......##
##.....#####..........###########....#..........###.......##
##....#######...........########....###.........####......##
##....#######............######....####........#####......##
##....#######.............####....#####.......#####......###
#......######..............###....####........####......####
#.......######.............###...####.........###.......####
#........#####.............###..####.....................###
##........####..............#...####.....................###
#####......##...................####.....................###
######...........................##.....................####
######..................................................####
######.........###.....................####.............####
######......#########.................######............####
#######....#############.......##############.....###..#####
##############################################..############
############################################################
</pre>
<h2> <span class="mw-headline" id="Advantages"> Advantages </span></h2>
<p>Some advantages include:
</p>
<ul><li> Procedurally generated so no two levels are (likely) exactly the same.
</li><li> Relatively simple concept, and implementation.
</li><li> A natural, cave-like map to add variety, uniqueness or an alternative to room-based dungeons.
</li></ul>
<p><br>
</p>
<h2> <span class="mw-headline" id="Disadvantages"> Disadvantages </span></h2>
<p>Some disadvantages include:
</p>
<ul><li> Generation of isolated cave sections, possibly blocking player advancement (see possible solutions below).
</li><li> Probably not appropriate for generating towns, so other map generators will probably need to be implemented.
</li><li> Very large maps tend to not look as natural, or may require some very fine tuning.
</li></ul>
<h2> <span class="mw-headline" id="The_isolated_cave_problem"> The isolated cave problem </span></h2>
<p>The problem is that the results are inconsistent. The algorithm prone to generating disconnected maps. See example below:
</p>
<pre>############################################################
#####################################################..#####
#####.....##################...###############............##
#####......###########.####....########.#####..............#
#####.......#########..###.....###############.............#
####.............#####.###....###################.........##
###...............########...####################........###
##.................#######...####################........###
##.......##.........#####.....##################.........###
##......####.........###.......################...........##
##.....########.................#######..######...........##
##...###########................######...#######..........##
#########..######..............######....########........###
########....######..#####......#####.....##########......###
#######......#############.....#####.....###########.....###
#######.......############......###.......###########.....##
#######.......###########.......###.......###########.....##
######.......####..######.......####.......#########......##
#####.......####....#####.......####..........######.....###
####........####......####......####...........#####.....###
####.........###.......###......####...##......######.....##
####...##.....###.......#......###########.....#######.....#
#####.####.....#####...........############....########....#
##########.....######..........############....#########..##
#########.......#####...........##########.....#############
#########.......####...............#####........############
##########......####................###...........##########
###########....#####.....######.....####...........#########
################################...##########.....##########
############################################################
</pre>
<p>It also sometimes generates maps which consist of one huge open space:
</p>
<pre>############################################################
############################################################
#################.####.######..######........###############
########...#####...##...####....####..........######...#####
###.####...####....###..####....####..........#####.....####
##...###....##.....###...##.....###............###......####
###.####...........###..........###.....###.........########
########...........###...........#.......#.........#########
#######.............#..............................#########
######.....##..........................................#####
###.......###...........................................####
##.......####...........................................####
##......................................................####
##.....................................................#####
##.....................................................#####
#.....................................##...............#####
#.....................................##................####
#...........................###......###................####
##...........###............###.....#####...............####
###...........#..............##.....######............######
######.......................##......######........#########
##########..................##.........#####......##########
###########................###..........####......##########
############................#...........####......##########
###.....#####.........##...............#####.......####..###
###.....#####.......#####.............#####..............###
###.....####.......#####..............#####.....##.......###
####...#####.......#####.....#####...######....####.....####
#############.##########....################..##############
############################################################
</pre>
<p>There are many ways to fix the disjoint segments problem. One approach might be to throw away maps that have disjoint segments in them. Another approach would be to connect the segments after the fact. Another still would be to fill in all but the biggest segment. We can't just retry when we get a disjoint map, because if the map is big then, statistically, that will be almost 100% of the time. Filling in all but the biggest segment will tend to produce a small area in a map that was supposed to be big. Connecting up the regions works, but it tends to look unnatural, as in the example from above, now connected:
</p>
<pre>############################################################
#####################################################..#####
#####.....##################...###############............##
#####......###########.####....########....................#
#####.......#########..###.....###############.............#
####.............####..###....###################.........##
###...............###.####...####################........###
##.................##.####...####################........###
##.......##.........#.###.....##################.........###
##......####..........##.......################...........##
##.....########.................#######..######...........##
##...###########................######...#######..........##
#########..######..............######....########........###
########............#####......#####.....##########......###
#######......#############...............###########.....###
#######.......############......###.......###########.....##
#######.......###########.......###.......###########.....##
######.......####..######.......####.......#########......##
#####.......####....#####.......####.....................###
####........####......####......####...........#####.....###
####.........###.......###......####...##......######.....##
####...##.....###.......#......###########.....#######.....#
#####.####.....#####...........############....########....#
##########.....######..........############....#########..##
#########.......#####...........##########.....#############
#########.......####...............#####........############
##########......####................###...........##########
###########....#####.....######.....####...........#########
################################...##########.....##########
############################################################
</pre>
<h3> <span class="mw-headline" id="Rule_Tweaking"> Rule Tweaking </span></h3>
<p>The solution to both problems, as it turns out, is to revisit the original cellular automata rules. Recall that the original rule was
</p>
<ul><li> There is a wall initially at P with 45% probability
</li><li> In the next generation, there is a wall at spot P if the number of tiles around P which are walls is at least 5
</li></ul>
<p>Or, in more compact notation:
</p>
<ul><li> Winit(p) = rand(0,100) &lt; 45
</li><li> R(p) = the number of tiles within 1 step of p which are walls
</li><li> W'(p) = R(p) &gt;= 5
</li></ul>
<p>Now, one of the problems was that we tend to get big, open areas. So why not try filling those areas in? Change the rule to
</p>
<ul><li> W'(p) = R(p) &gt;= 5 or p is in the middle of an open space
</li></ul>
<p>Or more formally,
</p>
<ul><li> Rn(p) = the number of tiles within n steps of p which are walls
</li><li> W'(p) = R1(p)&gt;=5 || R2(p)=0
</li></ul>
<p>So how does it look?
</p>
<pre>Winit(p) = rand(0,100) &lt; 45
Repeat 5: W'(p) = R1(p) &gt;= 5 || R2(p) &lt;= 1
</pre>
<pre>############################################################
##....######################################################
#.......###..#####..####....###########################..###
#...#.........###.............##########..############....##
##...###...#..###..............########....######..###....##
###...######...#..##...........######.....######....###..###
####..######......##..##........####...#..######....########
####..###.#.......#...##...#.....##...###..######...########
#####.........##...........##........####.....##.....#######
#####.........##...........#.......##.....#.............####
####...###...##................#...##......###...........###
####...###..##...###....##.....##..##..##..###....##.....###
#########..###..####...###.............###..##..####.....###
########...##..#####...##...............#...#...####....####
#######........######......###...##....................#####
#######..##.....######....##########...................#####
######..####.......####...#########...................######
####....####..##....##.....#######...##..............#######
###.....###..#####......#...####....##................######
##..##..###..###........##.........#....#......##......#####
#..####..##...##.................###...##.....####......####
#.....#..###..#..##..........#..###..###.....#####......####
##.......####.....#...##........##..###....#######......####
######....###.......................###...#######....#######
#######......................##.....###...#######...########
########.................#######....####...#####....########
########..............###########..######...........########
#########....####....######################........#########
###################.########################################
############################################################
</pre>
<p>This is more interesting - it doesn't have any big open areas, it has a decent layout. It's almost fully connected. Still, it has some new problems: there are isolated single-tile walls in places, and in general it's not very smooth. But with a little tweaking:
</p>
<pre>Winit(p) = rand(0,100) &lt; 40
Repeat 4: W'(p) = R1(p) &gt;= 5 || R2(p) &lt;= 2
Repeat 3: W'(p) = R1(p) &gt;= 5
</pre>
<pre>############################################################
###...###########..#############################.....#######
##..........####....################..#########.........####
##...........##.....####..#########.......####..######...###
##.......#..........###....###.................########..###
##......###........###........................#########..###
##.......##.........#........................##########...##
##.......###...........##.............###....#########.....#
##.......######.......####...........#####....#####........#
###.....#########....#####...........######...#####........#
###########################...........#####...#######.....##
#############...###########.............##....########....##
############.........#######...................#######....##
###########...........########......###............##....###
###..#####.............#########...##########............###
##....###...............######################..........####
###..........................######..#########..........####
####..........................###.....#######...........####
####.................##................##................###
####...###..........####...............#..................##
###...#####.........####..............##......##...........#
##....########......#####............####....####..........#
##....#########.....#####............####....####..........#
##.....######.......#####.............##.....####...##.....#
##......##..........#####....................####..####....#
###.................####.........###........############..##
###............##..######.###...############################
####..........##############################################
######..####################################################
############################################################
</pre>
<p>Notice that the initial fill percentage is a little lower, the cutoffs are different, and we switch rules after a few generations. This is more like the desired result. In the Example Output section, you can see some samples with these parameters, at various sizes.
</p>
<h3> <span class="mw-headline" id="Flood_Fill"> Flood Fill </span></h3>
<p>This algorithm creates good looking caves, but the problem is isolated caves. The way I solved this is by picking a random, open point on the map and flood filling. Any open point outside the flood filled portion gets turned back into a wall. I then check to see if the flood filled portion of the map is more than some threshold percent of the map. If the map is ~45% open it usually looks alright. If the percent is below this, I just start over.
</p><p>This turns out to work quite well. On large maps, almost always you will select the largest open connected area, and you won't have to restart the regeneration very often, if at all. On very small maps, this doesn't happen as often, but its also very quick to regenerate because the map is small. It ends up that this method just does the right thing to rectify the non-connected maps naturally!
-<a href="http://www.roguebasin.com/index.php?title=User:Jlund3" title="User:Jlund3" class="mw-redirect">Jlund3</a>
</p>
<h3> <span class="mw-headline" id="Horizontal_Blanking"> Horizontal Blanking </span></h3>
<p>Another approach to fixing the problem of disconnected areas involves blanking a horizontal strip of walls, about 3 or 4 block tall, in the middle of of the map after the random fill, but before beginning the automata iterations. Depending on the rules, a horizontal strip of sufficient width will prevent a continuous vertical wall from forming, creating disconnected cave sections.
</p>
<h2> <span class="mw-headline" id="Example_Output"> Example Output </span></h2>
<p>Animated GIF of the cellular automata cave process with 12 smoothing iterations (Generated using haskell):
<img src="http://filesmelt.com/dl/cavegen.gif" alt="cavegen.gif">
</p>
<pre>##############################
##..###....###.....###########
#...........................##
#.................##.........#
##..###..........#######.....#
########.........#######.....#
############......####......##
#############...............##
###..########...............##
##....#######...###..#......##
##.....######...#######.....##
##......#####...######......##
##...#...###....#####.......##
##..##.........######.......##
##..........##########......##
###........#####..####.....###
###........####....###.....###
###....##...##.....###.....###
###...####........####......##
###...#####......#####......##
##....#####.....#####.......##
##.....###.....####.........##
##..............##..........##
###.........................##
####........................##
####.......................###
####..........##...........###
#####...###..####.........####
####################.....#####
##############################
</pre>
<pre>############################################################
#########......###...##........####...####.....#############
####............................##.....##............#######
###................###.....##..........................#####
###...............#####...####..........................####
###...............#####....####............#............####
####...###.........####.......##.......................#####
##########..........###........##.....................######
##########...........#..........##...................#######
#########.......................#####..............#########
######.........................#######...#......############
#####..........................############....#############
####...........................###########......######..####
###..........##.................#########................###
##.......#######........#..........######...###.........####
##......########.......##............###...######.....######
###.....#######...............#####........########..#######
###......#####...##...........######........################
###......#####..####...........#####.........###############
#######..#####..####............###...........#######....###
########..###...#####......###.................#####......##
########.......######......####.................###.......##
########.......######.......##....##..................##..##
#######.......######....##.......####................####..#
######.......#######....###......####..........###..#####..#
#####........######.....######....##..........##########...#
######........###........######...............########.....#
##########...............#######.............########.....##
#############...#######..###########...#####################
############################################################
</pre>
<pre>################################################################
#######..#####............####..####...###....###########...####
###......####..................................#########.....###
##.......###.......................................####......###
##......####.............##.........................##......####
##......#####......##...####................##..............####
##......##############..#####...............###.............####
##.....###############...#####...............##........##...####
##.....################..######.........#.............####...###
##.....################...#####........###............####....##
###.....#####..##...##....####.........###.............###....##
####....####..............###..........###...................###
####....####.............####..........##....................###
###.....####...........#####.........................##.....####
##.......##............#####....................##..####...#####
##.....................######................###########...#####
###..##........##......###############.....############....#####
########......####....#################..###############..######
#########...####################################################
################################################################ 
</pre>
<pre>############################################################
#########......###...##........####...####.....#############
####............................##.....##............#######
###................###.....##..........................#####
###...............#####...####..........................####
###...............#####....####............#............####
####...###.........####.......##.......................#####
##########..........###........##.....................######
##########...........#..........##...................#######
#########.......................#####..............#########
######.........................#######...#......############
#####..........................############....#############
####...........................###########......######..####
###..........##.................#########................###
##.......#######........#..........######...###.........####
##......########.......##............###...######.....######
###.....#######...............#####........########..#######
###......#####...##...........######........################
###......#####..####...........#####.........###############
#######..#####..####............###...........#######....###
########..###...#####......###.................#####......##
########.......######......####.................###.......##
########.......######.......##....##..................##..##
#######.......######....##.......####.........##.....####..#
#####........#######....###......####........#####..#####..#
####........#######.....######...#####.......############..#
####.......######..........####..#########..#############..#
###........#####............###..########################.##
##.........####.............###..################.######..##
#....###...####......####....#...######..#######...#####..##
#.....#.....##......######.......#####....#####....#####..##
#...................######........####....###.....#####...##
#....................#####........#####..###......##......##
#....................######........########................#
##......#............########.......#######................#
##......##...........#########......#######...............##
###.....#............####...##.....#######..##...........###
###..........#......####...........######..####..........###
##..........####....####...........#####..######.........###
##...........####..#####............##....######.........###
##............###..######......#...........####..........###
##............###..#######.....##........................###
##.......###...#....#######....#..........................##
###......###.........######.........................##.....#
###.......#..........######........#####...........####....#
###............###...######......########.........#####....#
###...........#####..######.....#########.........####.....#
###...........#####.#######.....########...........###.....#
###...........####..########...#########......##...###....##
###...........####...##################......####..###....##
###...........####......##############.......####..###....##
###...........####..........##########........##...###....##
###............####..........#########.............####..###
###...........#####...........#######..............#########
###.....##########............######.......##......#########
##.....###########.....###.....####.......####......########
##.....############....###......##.......#####........######
###...##############..#####.............#######.......######
################################...##..#####################
############################################################
</pre>
<p><br>
</p>
<h2> <span class="mw-headline" id="Example_Code"> Example Code </span></h2>
<h3> <span class="mw-headline" id="C_Code"> C Code </span></h3>
<p>Original article by <a href="http://www.roguebasin.com/index.php?title=Jim_Babcock&amp;action=edit&amp;redlink=1" class="new" title="Jim Babcock (page does not exist)">Jim Babcock</a>
</p>
<div style="background-color: #EEEEEE; border-style: dotted; padding: 0.3em">
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="c source-c"><pre class="de1"> <span class="co2">#include &lt;stdio.h&gt;</span>
 <span class="co2">#include &lt;stdlib.h&gt;</span>
 <span class="co2">#include &lt;time.h&gt;</span>
&nbsp;
 <span class="co2">#define TILE_FLOOR 0</span>
 <span class="co2">#define TILE_WALL 1</span>
&nbsp;
 <span class="kw4">typedef</span> <span class="kw4">struct</span> <span class="br0">{</span>
 	<span class="kw4">int</span> r1_cutoff<span class="sy0">,</span> r2_cutoff<span class="sy0">;</span>
 	<span class="kw4">int</span> reps<span class="sy0">;</span>
 <span class="br0">}</span> generation_params<span class="sy0">;</span> 
&nbsp;
 <span class="kw4">int</span> <span class="sy0">**</span>grid<span class="sy0">;</span>
 <span class="kw4">int</span> <span class="sy0">**</span>grid2<span class="sy0">;</span> 
&nbsp;
 <span class="kw4">int</span> fillprob <span class="sy0">=</span> <span class="nu0">40</span><span class="sy0">;</span>
 <span class="kw4">int</span> r1_cutoff <span class="sy0">=</span> <span class="nu0">5</span><span class="sy0">,</span> r2_cutoff <span class="sy0">=</span> <span class="nu0">2</span><span class="sy0">;</span>
 <span class="kw4">int</span> size_x <span class="sy0">=</span> <span class="nu0">64</span><span class="sy0">,</span> size_y <span class="sy0">=</span> <span class="nu0">20</span><span class="sy0">;</span>
 generation_params <span class="sy0">*</span>params<span class="sy0">;</span>  
&nbsp;
 generation_params <span class="sy0">*</span>params_set<span class="sy0">;</span>
 <span class="kw4">int</span> generations<span class="sy0">;</span>
&nbsp;
 <span class="kw4">int</span> randpick<span class="br0">(</span><span class="kw4">void</span><span class="br0">)</span>
 <span class="br0">{</span>
 	<span class="kw1">if</span><span class="br0">(</span>rand<span class="br0">(</span><span class="br0">)</span><span class="sy0">%</span><span class="nu19">100</span> <span class="sy0">&lt;</span> fillprob<span class="br0">)</span>
 		<span class="kw1">return</span> TILE_WALL<span class="sy0">;</span>
 	<span class="kw1">else</span>
 		<span class="kw1">return</span> TILE_FLOOR<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw4">void</span> initmap<span class="br0">(</span><span class="kw4">void</span><span class="br0">)</span>
 <span class="br0">{</span>
	<span class="kw4">int</span> xi<span class="sy0">,</span> yi<span class="sy0">;</span>
&nbsp;
	grid  <span class="sy0">=</span> <span class="br0">(</span><span class="kw4">int</span><span class="sy0">**</span><span class="br0">)</span>malloc<span class="br0">(</span><span class="kw4">sizeof</span><span class="br0">(</span><span class="kw4">int</span><span class="sy0">*</span><span class="br0">)</span> <span class="sy0">*</span> size_y<span class="br0">)</span><span class="sy0">;</span>
	grid2 <span class="sy0">=</span> <span class="br0">(</span><span class="kw4">int</span><span class="sy0">**</span><span class="br0">)</span>malloc<span class="br0">(</span><span class="kw4">sizeof</span><span class="br0">(</span><span class="kw4">int</span><span class="sy0">*</span><span class="br0">)</span> <span class="sy0">*</span> size_y<span class="br0">)</span><span class="sy0">;</span>
&nbsp;
	<span class="kw1">for</span><span class="br0">(</span>yi<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> yi<span class="sy0">&lt;</span>size_y<span class="sy0">;</span> yi<span class="sy0">++</span><span class="br0">)</span>
	<span class="br0">{</span>
		grid <span class="br0">[</span>yi<span class="br0">]</span> <span class="sy0">=</span> <span class="br0">(</span><span class="kw4">int</span><span class="sy0">*</span><span class="br0">)</span>malloc<span class="br0">(</span><span class="kw4">sizeof</span><span class="br0">(</span><span class="kw4">int</span><span class="br0">)</span> <span class="sy0">*</span> size_x<span class="br0">)</span><span class="sy0">;</span>
		grid2<span class="br0">[</span>yi<span class="br0">]</span> <span class="sy0">=</span> <span class="br0">(</span><span class="kw4">int</span><span class="sy0">*</span><span class="br0">)</span>malloc<span class="br0">(</span><span class="kw4">sizeof</span><span class="br0">(</span><span class="kw4">int</span><span class="br0">)</span> <span class="sy0">*</span> size_x<span class="br0">)</span><span class="sy0">;</span>
	<span class="br0">}</span>
&nbsp;
	<span class="kw1">for</span><span class="br0">(</span>yi<span class="sy0">=</span><span class="nu0">1</span><span class="sy0">;</span> yi<span class="sy0">&lt;</span>size_y<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">;</span> yi<span class="sy0">++</span><span class="br0">)</span>
	<span class="kw1">for</span><span class="br0">(</span>xi<span class="sy0">=</span><span class="nu0">1</span><span class="sy0">;</span> xi<span class="sy0">&lt;</span>size_x<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">;</span> xi<span class="sy0">++</span><span class="br0">)</span>
		grid<span class="br0">[</span>yi<span class="br0">]</span><span class="br0">[</span>xi<span class="br0">]</span> <span class="sy0">=</span> randpick<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
	<span class="kw1">for</span><span class="br0">(</span>yi<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> yi<span class="sy0">&lt;</span>size_y<span class="sy0">;</span> yi<span class="sy0">++</span><span class="br0">)</span>
	<span class="kw1">for</span><span class="br0">(</span>xi<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> xi<span class="sy0">&lt;</span>size_x<span class="sy0">;</span> xi<span class="sy0">++</span><span class="br0">)</span>
		grid2<span class="br0">[</span>yi<span class="br0">]</span><span class="br0">[</span>xi<span class="br0">]</span> <span class="sy0">=</span> TILE_WALL<span class="sy0">;</span>
&nbsp;
	<span class="kw1">for</span><span class="br0">(</span>yi<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> yi<span class="sy0">&lt;</span>size_y<span class="sy0">;</span> yi<span class="sy0">++</span><span class="br0">)</span>
		grid<span class="br0">[</span>yi<span class="br0">]</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> <span class="sy0">=</span> grid<span class="br0">[</span>yi<span class="br0">]</span><span class="br0">[</span>size_x<span class="sy0">-</span><span class="nu0">1</span><span class="br0">]</span> <span class="sy0">=</span> TILE_WALL<span class="sy0">;</span>
	<span class="kw1">for</span><span class="br0">(</span>xi<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> xi<span class="sy0">&lt;</span>size_x<span class="sy0">;</span> xi<span class="sy0">++</span><span class="br0">)</span>
		grid<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">[</span>xi<span class="br0">]</span> <span class="sy0">=</span> grid<span class="br0">[</span>size_y<span class="sy0">-</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">[</span>xi<span class="br0">]</span> <span class="sy0">=</span> TILE_WALL<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw4">void</span> generation<span class="br0">(</span><span class="kw4">void</span><span class="br0">)</span>
 <span class="br0">{</span>
	<span class="kw4">int</span> xi<span class="sy0">,</span> yi<span class="sy0">,</span> ii<span class="sy0">,</span> jj<span class="sy0">;</span>
&nbsp;
	<span class="kw1">for</span><span class="br0">(</span>yi<span class="sy0">=</span><span class="nu0">1</span><span class="sy0">;</span> yi<span class="sy0">&lt;</span>size_y<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">;</span> yi<span class="sy0">++</span><span class="br0">)</span>
	<span class="kw1">for</span><span class="br0">(</span>xi<span class="sy0">=</span><span class="nu0">1</span><span class="sy0">;</span> xi<span class="sy0">&lt;</span>size_x<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">;</span> xi<span class="sy0">++</span><span class="br0">)</span>
 	<span class="br0">{</span>
 		<span class="kw4">int</span> adjcount_r1 <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">,</span>
 		    adjcount_r2 <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
&nbsp;
 		<span class="kw1">for</span><span class="br0">(</span>ii<span class="sy0">=-</span><span class="nu0">1</span><span class="sy0">;</span> ii<span class="sy0">&lt;=</span><span class="nu0">1</span><span class="sy0">;</span> ii<span class="sy0">++</span><span class="br0">)</span>
		<span class="kw1">for</span><span class="br0">(</span>jj<span class="sy0">=-</span><span class="nu0">1</span><span class="sy0">;</span> jj<span class="sy0">&lt;=</span><span class="nu0">1</span><span class="sy0">;</span> jj<span class="sy0">++</span><span class="br0">)</span>
 		<span class="br0">{</span>
 			<span class="kw1">if</span><span class="br0">(</span>grid<span class="br0">[</span>yi<span class="sy0">+</span>ii<span class="br0">]</span><span class="br0">[</span>xi<span class="sy0">+</span>jj<span class="br0">]</span> <span class="sy0">!=</span> TILE_FLOOR<span class="br0">)</span>
 				adjcount_r1<span class="sy0">++;</span>
 		<span class="br0">}</span>
 		<span class="kw1">for</span><span class="br0">(</span>ii<span class="sy0">=</span>yi<span class="sy0">-</span><span class="nu0">2</span><span class="sy0">;</span> ii<span class="sy0">&lt;=</span>yi<span class="sy0">+</span><span class="nu0">2</span><span class="sy0">;</span> ii<span class="sy0">++</span><span class="br0">)</span>
 		<span class="kw1">for</span><span class="br0">(</span>jj<span class="sy0">=</span>xi<span class="sy0">-</span><span class="nu0">2</span><span class="sy0">;</span> jj<span class="sy0">&lt;=</span>xi<span class="sy0">+</span><span class="nu0">2</span><span class="sy0">;</span> jj<span class="sy0">++</span><span class="br0">)</span>
 		<span class="br0">{</span>
 			<span class="kw1">if</span><span class="br0">(</span>abs<span class="br0">(</span>ii<span class="sy0">-</span>yi<span class="br0">)</span><span class="sy0">==</span><span class="nu0">2</span> <span class="sy0">&amp;&amp;</span> abs<span class="br0">(</span>jj<span class="sy0">-</span>xi<span class="br0">)</span><span class="sy0">==</span><span class="nu0">2</span><span class="br0">)</span>
 				<span class="kw1">continue</span><span class="sy0">;</span>
 			<span class="kw1">if</span><span class="br0">(</span>ii<span class="sy0">&lt;</span><span class="nu0">0</span> <span class="sy0">||</span> jj<span class="sy0">&lt;</span><span class="nu0">0</span> <span class="sy0">||</span> ii<span class="sy0">&gt;=</span>size_y <span class="sy0">||</span> jj<span class="sy0">&gt;=</span>size_x<span class="br0">)</span>
 				<span class="kw1">continue</span><span class="sy0">;</span>
 			<span class="kw1">if</span><span class="br0">(</span>grid<span class="br0">[</span>ii<span class="br0">]</span><span class="br0">[</span>jj<span class="br0">]</span> <span class="sy0">!=</span> TILE_FLOOR<span class="br0">)</span>
 				adjcount_r2<span class="sy0">++;</span>
 		<span class="br0">}</span>
 		<span class="kw1">if</span><span class="br0">(</span>adjcount_r1 <span class="sy0">&gt;=</span> params<span class="sy0">-&gt;</span>r1_cutoff <span class="sy0">||</span> adjcount_r2 <span class="sy0">&lt;=</span> params<span class="sy0">-&gt;</span>r2_cutoff<span class="br0">)</span>
 			grid2<span class="br0">[</span>yi<span class="br0">]</span><span class="br0">[</span>xi<span class="br0">]</span> <span class="sy0">=</span> TILE_WALL<span class="sy0">;</span>
 		<span class="kw1">else</span>
 			grid2<span class="br0">[</span>yi<span class="br0">]</span><span class="br0">[</span>xi<span class="br0">]</span> <span class="sy0">=</span> TILE_FLOOR<span class="sy0">;</span>
 	<span class="br0">}</span>
 	<span class="kw1">for</span><span class="br0">(</span>yi<span class="sy0">=</span><span class="nu0">1</span><span class="sy0">;</span> yi<span class="sy0">&lt;</span>size_y<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">;</span> yi<span class="sy0">++</span><span class="br0">)</span>
 	<span class="kw1">for</span><span class="br0">(</span>xi<span class="sy0">=</span><span class="nu0">1</span><span class="sy0">;</span> xi<span class="sy0">&lt;</span>size_x<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">;</span> xi<span class="sy0">++</span><span class="br0">)</span>
 		grid<span class="br0">[</span>yi<span class="br0">]</span><span class="br0">[</span>xi<span class="br0">]</span> <span class="sy0">=</span> grid2<span class="br0">[</span>yi<span class="br0">]</span><span class="br0">[</span>xi<span class="br0">]</span><span class="sy0">;</span>
 <span class="br0">}</span> 
&nbsp;
 <span class="kw4">void</span> printfunc<span class="br0">(</span><span class="kw4">void</span><span class="br0">)</span>
 <span class="br0">{</span>
 	<span class="kw4">int</span> ii<span class="sy0">;</span>
&nbsp;
 	<span class="kw3">printf</span><span class="br0">(</span><span class="st0">"W[0](p) = rand[0,100) &lt;&nbsp;%i<span class="es1">\n</span>"</span><span class="sy0">,</span> fillprob<span class="br0">)</span><span class="sy0">;</span>
&nbsp;
 	<span class="kw1">for</span><span class="br0">(</span>ii<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> ii<span class="sy0">&lt;</span>generations<span class="sy0">;</span> ii<span class="sy0">++</span><span class="br0">)</span>
 	<span class="br0">{</span>
 		<span class="kw3">printf</span><span class="br0">(</span><span class="st0">"Repeat&nbsp;%i: W'(p) = R[1](p) &gt;=&nbsp;%i"</span><span class="sy0">,</span>
 			params_set<span class="br0">[</span>ii<span class="br0">]</span>.<span class="me1">reps</span><span class="sy0">,</span> params_set<span class="br0">[</span>ii<span class="br0">]</span>.<span class="me1">r1_cutoff</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
 		<span class="kw1">if</span><span class="br0">(</span>params_set<span class="br0">[</span>ii<span class="br0">]</span>.<span class="me1">r2_cutoff</span> <span class="sy0">&gt;=</span> <span class="nu0">0</span><span class="br0">)</span>
 			<span class="kw3">printf</span><span class="br0">(</span><span class="st0">" || R[2](p) &lt;=&nbsp;%i<span class="es1">\n</span>"</span><span class="sy0">,</span> params_set<span class="br0">[</span>ii<span class="br0">]</span>.<span class="me1">r2_cutoff</span><span class="br0">)</span><span class="sy0">;</span>
 		<span class="kw1">else</span>
 			putchar<span class="br0">(</span><span class="st0">'<span class="es1">\n</span>'</span><span class="br0">)</span><span class="sy0">;</span>
 	<span class="br0">}</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw4">void</span> printmap<span class="br0">(</span><span class="kw4">void</span><span class="br0">)</span>
 <span class="br0">{</span>
 	<span class="kw4">int</span> xi<span class="sy0">,</span> yi<span class="sy0">;</span>
&nbsp;
 	<span class="kw1">for</span><span class="br0">(</span>yi<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> yi<span class="sy0">&lt;</span>size_y<span class="sy0">;</span> yi<span class="sy0">++</span><span class="br0">)</span>
 	<span class="br0">{</span>
 		<span class="kw1">for</span><span class="br0">(</span>xi<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> xi<span class="sy0">&lt;</span>size_x<span class="sy0">;</span> xi<span class="sy0">++</span><span class="br0">)</span>
 		<span class="br0">{</span>
 			<span class="kw1">switch</span><span class="br0">(</span>grid<span class="br0">[</span>yi<span class="br0">]</span><span class="br0">[</span>xi<span class="br0">]</span><span class="br0">)</span> <span class="br0">{</span>
 				<span class="kw1">case</span> TILE_WALL<span class="sy0">:</span>  putchar<span class="br0">(</span><span class="st0">'#'</span><span class="br0">)</span><span class="sy0">;</span> <span class="kw2">break</span><span class="sy0">;</span>
 				<span class="kw1">case</span> TILE_FLOOR<span class="sy0">:</span> putchar<span class="br0">(</span><span class="st0">'.'</span><span class="br0">)</span><span class="sy0">;</span> <span class="kw2">break</span><span class="sy0">;</span>
 			<span class="br0">}</span>
 		<span class="br0">}</span>
 		putchar<span class="br0">(</span><span class="st0">'<span class="es1">\n</span>'</span><span class="br0">)</span><span class="sy0">;</span>
 	<span class="br0">}</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw4">int</span> main<span class="br0">(</span><span class="kw4">int</span> argc<span class="sy0">,</span> <span class="kw4">char</span> <span class="sy0">**</span>argv<span class="br0">)</span>
 <span class="br0">{</span>
 	<span class="kw4">int</span> ii<span class="sy0">,</span> jj<span class="sy0">;</span>
&nbsp;
 	<span class="kw1">if</span><span class="br0">(</span>argc <span class="sy0">&lt;</span> <span class="nu0">7</span><span class="br0">)</span> <span class="br0">{</span>
 		<span class="kw3">printf</span><span class="br0">(</span><span class="st0">"Usage:&nbsp;%s xsize ysize fill (r1 r2 count)+<span class="es1">\n</span>"</span><span class="sy0">,</span> argv<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span>
 		<span class="kw1">return</span> <span class="nu0">1</span><span class="sy0">;</span>
 	<span class="br0">}</span>
 	size_x     <span class="sy0">=</span> atoi<span class="br0">(</span>argv<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span>
 	size_y     <span class="sy0">=</span> atoi<span class="br0">(</span>argv<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span>
 	fillprob   <span class="sy0">=</span> atoi<span class="br0">(</span>argv<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
 	generations <span class="sy0">=</span> <span class="br0">(</span>argc<span class="sy0">-</span><span class="nu0">4</span><span class="br0">)</span><span class="sy0">/</span><span class="nu0">3</span><span class="sy0">;</span>
&nbsp;
 	params <span class="sy0">=</span> params_set <span class="sy0">=</span> <span class="br0">(</span>generation_params<span class="sy0">*</span><span class="br0">)</span>malloc<span class="br0">(</span> <span class="kw4">sizeof</span><span class="br0">(</span>generation_params<span class="br0">)</span> <span class="sy0">*</span> generations <span class="br0">)</span><span class="sy0">;</span>
&nbsp;
 	<span class="kw1">for</span><span class="br0">(</span>ii<span class="sy0">=</span><span class="nu0">4</span><span class="sy0">;</span> ii<span class="sy0">+</span><span class="nu0">2</span><span class="sy0">&lt;</span>argc<span class="sy0">;</span> ii<span class="sy0">+=</span><span class="nu0">3</span><span class="br0">)</span>
 	<span class="br0">{</span>
 		params<span class="sy0">-&gt;</span>r1_cutoff  <span class="sy0">=</span> atoi<span class="br0">(</span>argv<span class="br0">[</span>ii<span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span>
 		params<span class="sy0">-&gt;</span>r2_cutoff  <span class="sy0">=</span> atoi<span class="br0">(</span>argv<span class="br0">[</span>ii<span class="sy0">+</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span>
 		params<span class="sy0">-&gt;</span>reps <span class="sy0">=</span> atoi<span class="br0">(</span>argv<span class="br0">[</span>ii<span class="sy0">+</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span>
 		params<span class="sy0">++;</span>
 	<span class="br0">}</span>
&nbsp;
 	srand<span class="br0">(</span>time<span class="br0">(</span>NULL<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
 	initmap<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
 	<span class="kw1">for</span><span class="br0">(</span>ii<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> ii<span class="sy0">&lt;</span>generations<span class="sy0">;</span> ii<span class="sy0">++</span><span class="br0">)</span>
 	<span class="br0">{</span>
 		params <span class="sy0">=</span> <span class="sy0">&amp;</span>params_set<span class="br0">[</span>ii<span class="br0">]</span><span class="sy0">;</span>
 		<span class="kw1">for</span><span class="br0">(</span>jj<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> jj<span class="sy0">&lt;</span>params<span class="sy0">-&gt;</span>reps<span class="sy0">;</span> jj<span class="sy0">++</span><span class="br0">)</span>
 			generation<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 	<span class="br0">}</span>
 	printfunc<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 	printmap<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 	<span class="kw1">return</span> <span class="nu0">0</span><span class="sy0">;</span>
 <span class="br0">}</span></pre></div></div>
</div>
<p><br>
</p>
<h3> <span class="mw-headline" id="C.23_Code"> C# Code </span></h3>
<p>Borrowed from <a rel="nofollow" class="external text" href="http://www.csharpprogramming.tips/2013/07/Rouge-like-dungeon-generation.html">csharpprogramming.tips</a> with permission from owner Adam Rakaska.
</p>
<div style="background-color: #EEEEEE; border-style: dotted; padding: 0.3em">
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="csharp source-csharp"><pre class="de1"><span class="kw1">public</span> <span class="kw4">class</span> MapHandler
<span class="br0">{</span>
	Random rand <span class="sy0">=</span> <span class="kw3">new</span> Random<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
	<span class="kw1">public</span> <span class="kw4">int</span><span class="br0">[</span>,<span class="br0">]</span> Map<span class="sy0">;</span>
&nbsp;
	<span class="kw1">public</span> <span class="kw4">int</span> MapWidth		<span class="br0">{</span> get<span class="sy0">;</span> set<span class="sy0">;</span> <span class="br0">}</span>
	<span class="kw1">public</span> <span class="kw4">int</span> MapHeight		<span class="br0">{</span> get<span class="sy0">;</span> set<span class="sy0">;</span> <span class="br0">}</span>
	<span class="kw1">public</span> <span class="kw4">int</span> PercentAreWalls	<span class="br0">{</span> get<span class="sy0">;</span> set<span class="sy0">;</span> <span class="br0">}</span>
&nbsp;
	<span class="kw1">public</span> MapHandler<span class="br0">(</span><span class="br0">)</span>
	<span class="br0">{</span>
		MapWidth <span class="sy0">=</span> <span class="nu0">40</span><span class="sy0">;</span>
		MapHeight <span class="sy0">=</span> <span class="nu0">21</span><span class="sy0">;</span>
		PercentAreWalls <span class="sy0">=</span> <span class="nu0">40</span><span class="sy0">;</span>
&nbsp;
		RandomFillMap<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
	<span class="br0">}</span>
&nbsp;
	<span class="kw1">public</span> <span class="kw4">void</span> MakeCaverns<span class="br0">(</span><span class="br0">)</span>
	<span class="br0">{</span>
		<span class="co1">// By initilizing column in the outter loop, its only created ONCE</span>
		<span class="kw1">for</span><span class="br0">(</span><span class="kw4">int</span> column<span class="sy0">=</span><span class="nu0">0</span>, row<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> row <span class="sy0">&lt;=</span> MapHeight<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">;</span> row<span class="sy0">++</span><span class="br0">)</span>
		<span class="br0">{</span>
			<span class="kw1">for</span><span class="br0">(</span>column <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> column <span class="sy0">&lt;=</span> MapWidth<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">;</span> column<span class="sy0">++</span><span class="br0">)</span>
			<span class="br0">{</span>
				Map<span class="br0">[</span>column,row<span class="br0">]</span> <span class="sy0">=</span> PlaceWallLogic<span class="br0">(</span>column,row<span class="br0">)</span><span class="sy0">;</span>
			<span class="br0">}</span>
		<span class="br0">}</span>
	<span class="br0">}</span>
&nbsp;
	<span class="kw1">public</span> <span class="kw4">int</span> PlaceWallLogic<span class="br0">(</span><span class="kw4">int</span> x,<span class="kw4">int</span> y<span class="br0">)</span>
	<span class="br0">{</span>
		<span class="kw4">int</span> numWalls <span class="sy0">=</span> GetAdjacentWalls<span class="br0">(</span>x,y,<span class="nu0">1</span>,<span class="nu0">1</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
&nbsp;
		<span class="kw1">if</span><span class="br0">(</span>Map<span class="br0">[</span>x,y<span class="br0">]</span><span class="sy0">==</span><span class="nu0">1</span><span class="br0">)</span>
		<span class="br0">{</span>
			<span class="kw1">if</span><span class="br0">(</span> numWalls <span class="sy0">&gt;=</span> <span class="nu0">4</span> <span class="br0">)</span>
			<span class="br0">{</span>
				<span class="kw1">return</span> <span class="nu0">1</span><span class="sy0">;</span>
			<span class="br0">}</span>
			<span class="kw1">if</span><span class="br0">(</span>numWalls<span class="sy0">&lt;</span><span class="nu0">2</span><span class="br0">)</span>
			<span class="br0">{</span>
				<span class="kw1">return</span> <span class="nu0">0</span><span class="sy0">;</span>
			<span class="br0">}</span>
&nbsp;
		<span class="br0">}</span>
		<span class="kw1">else</span>
		<span class="br0">{</span>
			<span class="kw1">if</span><span class="br0">(</span>numWalls<span class="sy0">&gt;=</span><span class="nu0">5</span><span class="br0">)</span>
			<span class="br0">{</span>
				<span class="kw1">return</span> <span class="nu0">1</span><span class="sy0">;</span>
			<span class="br0">}</span>
		<span class="br0">}</span>
		<span class="kw1">return</span> <span class="nu0">0</span><span class="sy0">;</span>
	<span class="br0">}</span>
&nbsp;
	<span class="kw1">public</span> <span class="kw4">int</span> GetAdjacentWalls<span class="br0">(</span><span class="kw4">int</span> x,<span class="kw4">int</span> y,<span class="kw4">int</span> scopeX,<span class="kw4">int</span> scopeY<span class="br0">)</span>
	<span class="br0">{</span>
		<span class="kw4">int</span> startX <span class="sy0">=</span> x <span class="sy0">-</span> scopeX<span class="sy0">;</span>
		<span class="kw4">int</span> startY <span class="sy0">=</span> y <span class="sy0">-</span> scopeY<span class="sy0">;</span>
		<span class="kw4">int</span> endX <span class="sy0">=</span> x <span class="sy0">+</span> scopeX<span class="sy0">;</span>
		<span class="kw4">int</span> endY <span class="sy0">=</span> y <span class="sy0">+</span> scopeY<span class="sy0">;</span>
&nbsp;
		<span class="kw4">int</span> iX <span class="sy0">=</span> startX<span class="sy0">;</span>
		<span class="kw4">int</span> iY <span class="sy0">=</span> startY<span class="sy0">;</span>
&nbsp;
		<span class="kw4">int</span> wallCounter <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
&nbsp;
		<span class="kw1">for</span><span class="br0">(</span>iY <span class="sy0">=</span> startY<span class="sy0">;</span> iY <span class="sy0">&lt;=</span> endY<span class="sy0">;</span> iY<span class="sy0">++</span><span class="br0">)</span> <span class="br0">{</span>
			<span class="kw1">for</span><span class="br0">(</span>iX <span class="sy0">=</span> startX<span class="sy0">;</span> iX <span class="sy0">&lt;=</span> endX<span class="sy0">;</span> iX<span class="sy0">++</span><span class="br0">)</span>
			<span class="br0">{</span>
				<span class="kw1">if</span><span class="br0">(</span><span class="sy0">!</span><span class="br0">(</span>iX<span class="sy0">==</span>x <span class="sy0">&amp;&amp;</span> iY<span class="sy0">==</span>y<span class="br0">)</span><span class="br0">)</span>
				<span class="br0">{</span>
					<span class="kw1">if</span><span class="br0">(</span>IsWall<span class="br0">(</span>iX,iY<span class="br0">)</span><span class="br0">)</span>
					<span class="br0">{</span>
						wallCounter <span class="sy0">+=</span> <span class="nu0">1</span><span class="sy0">;</span>
					<span class="br0">}</span>
				<span class="br0">}</span>
			<span class="br0">}</span>
		<span class="br0">}</span>
		<span class="kw1">return</span> wallCounter<span class="sy0">;</span>
	<span class="br0">}</span>
&nbsp;
	<span class="kw4">bool</span> IsWall<span class="br0">(</span><span class="kw4">int</span> x,<span class="kw4">int</span> y<span class="br0">)</span>
	<span class="br0">{</span>
		<span class="co1">// Consider out-of-bound a wall</span>
		<span class="kw1">if</span><span class="br0">(</span> IsOutOfBounds<span class="br0">(</span>x,y<span class="br0">)</span> <span class="br0">)</span>
		<span class="br0">{</span>
			<span class="kw1">return</span> <span class="kw1">true</span><span class="sy0">;</span>
		<span class="br0">}</span>
&nbsp;
		<span class="kw1">if</span><span class="br0">(</span> Map<span class="br0">[</span>x,y<span class="br0">]</span><span class="sy0">==</span><span class="nu0">1</span>	 <span class="br0">)</span>
		<span class="br0">{</span>
			<span class="kw1">return</span> <span class="kw1">true</span><span class="sy0">;</span>
		<span class="br0">}</span>
&nbsp;
		<span class="kw1">if</span><span class="br0">(</span> Map<span class="br0">[</span>x,y<span class="br0">]</span><span class="sy0">==</span><span class="nu0">0</span>	 <span class="br0">)</span>
		<span class="br0">{</span>
			<span class="kw1">return</span> <span class="kw1">false</span><span class="sy0">;</span>
		<span class="br0">}</span>
		<span class="kw1">return</span> <span class="kw1">false</span><span class="sy0">;</span>
	<span class="br0">}</span>
&nbsp;
	<span class="kw4">bool</span> IsOutOfBounds<span class="br0">(</span><span class="kw4">int</span> x, <span class="kw4">int</span> y<span class="br0">)</span>
	<span class="br0">{</span>
		<span class="kw1">if</span><span class="br0">(</span> x<span class="sy0">&lt;</span><span class="nu0">0</span> <span class="sy0">||</span> y<span class="sy0">&lt;</span><span class="nu0">0</span> <span class="br0">)</span>
		<span class="br0">{</span>
			<span class="kw1">return</span> <span class="kw1">true</span><span class="sy0">;</span>
		<span class="br0">}</span>
		<span class="kw1">else</span> <span class="kw1">if</span><span class="br0">(</span> x<span class="sy0">&gt;</span>MapWidth<span class="sy0">-</span><span class="nu0">1</span> <span class="sy0">||</span> y<span class="sy0">&gt;</span>MapHeight<span class="sy0">-</span><span class="nu0">1</span> <span class="br0">)</span>
		<span class="br0">{</span>
			<span class="kw1">return</span> <span class="kw1">true</span><span class="sy0">;</span>
		<span class="br0">}</span>
		<span class="kw1">return</span> <span class="kw1">false</span><span class="sy0">;</span>
	<span class="br0">}</span>
&nbsp;
	<span class="kw1">public</span> <span class="kw4">void</span> PrintMap<span class="br0">(</span><span class="br0">)</span>
	<span class="br0">{</span>
		Console<span class="sy0">.</span><span class="me1">Clear</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
		Console<span class="sy0">.</span><span class="me1">Write</span><span class="br0">(</span>MapToString<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
	<span class="br0">}</span>
&nbsp;
	<span class="kw4">string</span> MapToString<span class="br0">(</span><span class="br0">)</span>
	<span class="br0">{</span>
		<span class="kw4">string</span> returnString <span class="sy0">=</span> <span class="kw4">string</span><span class="sy0">.</span><span class="me1">Join</span><span class="br0">(</span><span class="st0">" "</span>, <span class="co1">// Seperator between each element</span>
		                                  <span class="st0">"Width:"</span>,
		                                  MapWidth<span class="sy0">.</span><span class="me1">ToString</span><span class="br0">(</span><span class="br0">)</span>,
		                                  <span class="st0">"<span class="es0">\t</span>Height:"</span>,
		                                  MapHeight<span class="sy0">.</span><span class="me1">ToString</span><span class="br0">(</span><span class="br0">)</span>,
		                                  <span class="st0">"<span class="es0">\t</span>% Walls:"</span>,
		                                  PercentAreWalls<span class="sy0">.</span><span class="me1">ToString</span><span class="br0">(</span><span class="br0">)</span>,
		                                  Environment<span class="sy0">.</span><span class="me1">NewLine</span>
		                                 <span class="br0">)</span><span class="sy0">;</span>
&nbsp;
		List<span class="sy0">&lt;</span><span class="kw4">string</span><span class="sy0">&gt;</span> mapSymbols <span class="sy0">=</span> <span class="kw3">new</span> List<span class="sy0">&lt;</span><span class="kw4">string</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
		mapSymbols<span class="sy0">.</span><span class="me1">Add</span><span class="br0">(</span><span class="st0">"."</span><span class="br0">)</span><span class="sy0">;</span>
		mapSymbols<span class="sy0">.</span><span class="me1">Add</span><span class="br0">(</span><span class="st0">"#"</span><span class="br0">)</span><span class="sy0">;</span>
		mapSymbols<span class="sy0">.</span><span class="me1">Add</span><span class="br0">(</span><span class="st0">"+"</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
		<span class="kw1">for</span><span class="br0">(</span><span class="kw4">int</span> column<span class="sy0">=</span><span class="nu0">0</span>,row<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> row <span class="sy0">&lt;</span> MapHeight<span class="sy0">;</span> row<span class="sy0">++</span> <span class="br0">)</span> <span class="br0">{</span>
			<span class="kw1">for</span><span class="br0">(</span> column <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> column <span class="sy0">&lt;</span> MapWidth<span class="sy0">;</span> column<span class="sy0">++</span> <span class="br0">)</span>
			<span class="br0">{</span>
				returnString <span class="sy0">+=</span> mapSymbols<span class="br0">[</span>Map<span class="br0">[</span>column,row<span class="br0">]</span><span class="br0">]</span><span class="sy0">;</span>
			<span class="br0">}</span>
			returnString <span class="sy0">+=</span> Environment<span class="sy0">.</span><span class="me1">NewLine</span><span class="sy0">;</span>
		<span class="br0">}</span>
		<span class="kw1">return</span> returnString<span class="sy0">;</span>
	<span class="br0">}</span>
&nbsp;
	<span class="kw1">public</span> <span class="kw4">void</span> BlankMap<span class="br0">(</span><span class="br0">)</span>
	<span class="br0">{</span>
		<span class="kw1">for</span><span class="br0">(</span><span class="kw4">int</span> column<span class="sy0">=</span><span class="nu0">0</span>,row<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> row <span class="sy0">&lt;</span> MapHeight<span class="sy0">;</span> row<span class="sy0">++</span><span class="br0">)</span> <span class="br0">{</span>
			<span class="kw1">for</span><span class="br0">(</span>column <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> column <span class="sy0">&lt;</span> MapWidth<span class="sy0">;</span> column<span class="sy0">++</span><span class="br0">)</span> <span class="br0">{</span>
				Map<span class="br0">[</span>column,row<span class="br0">]</span> <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
			<span class="br0">}</span>
		<span class="br0">}</span>
	<span class="br0">}</span>
&nbsp;
	<span class="kw1">public</span> <span class="kw4">void</span> RandomFillMap<span class="br0">(</span><span class="br0">)</span>
	<span class="br0">{</span>
		<span class="co1">// New, empty map</span>
		Map <span class="sy0">=</span> <span class="kw3">new</span> <span class="kw4">int</span><span class="br0">[</span>MapWidth,MapHeight<span class="br0">]</span><span class="sy0">;</span>
&nbsp;
		<span class="kw4">int</span> mapMiddle <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> <span class="co1">// Temp variable</span>
		<span class="kw1">for</span><span class="br0">(</span><span class="kw4">int</span> column<span class="sy0">=</span><span class="nu0">0</span>,row<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> row <span class="sy0">&lt;</span> MapHeight<span class="sy0">;</span> row<span class="sy0">++</span><span class="br0">)</span> <span class="br0">{</span>
			<span class="kw1">for</span><span class="br0">(</span>column <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> column <span class="sy0">&lt;</span> MapWidth<span class="sy0">;</span> column<span class="sy0">++</span><span class="br0">)</span>
			<span class="br0">{</span>
				<span class="co1">// If coordinants lie on the the edge of the map (creates a border)</span>
				<span class="kw1">if</span><span class="br0">(</span>column <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">)</span>
				<span class="br0">{</span>
					Map<span class="br0">[</span>column,row<span class="br0">]</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span>
				<span class="br0">}</span>
				<span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>row <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">)</span>
				<span class="br0">{</span>
					Map<span class="br0">[</span>column,row<span class="br0">]</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span>
				<span class="br0">}</span>
				<span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>column <span class="sy0">==</span> MapWidth<span class="sy0">-</span><span class="nu0">1</span><span class="br0">)</span>
				<span class="br0">{</span>
					Map<span class="br0">[</span>column,row<span class="br0">]</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span>
				<span class="br0">}</span>
				<span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>row <span class="sy0">==</span> MapHeight<span class="sy0">-</span><span class="nu0">1</span><span class="br0">)</span>
				<span class="br0">{</span>
					Map<span class="br0">[</span>column,row<span class="br0">]</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span>
				<span class="br0">}</span>
				<span class="co1">// Else, fill with a wall a random percent of the time</span>
				<span class="kw1">else</span>
				<span class="br0">{</span>
					mapMiddle <span class="sy0">=</span> <span class="br0">(</span>MapHeight <span class="sy0">/</span> <span class="nu0">2</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
					<span class="kw1">if</span><span class="br0">(</span>row <span class="sy0">==</span> mapMiddle<span class="br0">)</span>
					<span class="br0">{</span>
						Map<span class="br0">[</span>column,row<span class="br0">]</span> <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
					<span class="br0">}</span>
					<span class="kw1">else</span>
					<span class="br0">{</span>
						Map<span class="br0">[</span>column,row<span class="br0">]</span> <span class="sy0">=</span> RandomPercent<span class="br0">(</span>PercentAreWalls<span class="br0">)</span><span class="sy0">;</span>
					<span class="br0">}</span>
				<span class="br0">}</span>
			<span class="br0">}</span>
		<span class="br0">}</span>
	<span class="br0">}</span>
&nbsp;
	<span class="kw4">int</span> RandomPercent<span class="br0">(</span><span class="kw4">int</span> percent<span class="br0">)</span>
	<span class="br0">{</span>
		<span class="kw1">if</span><span class="br0">(</span>percent<span class="sy0">&gt;=</span>rand<span class="sy0">.</span><span class="me1">Next</span><span class="br0">(</span><span class="nu0">1</span>,<span class="nu0">101</span><span class="br0">)</span><span class="br0">)</span>
		<span class="br0">{</span>
			<span class="kw1">return</span> <span class="nu0">1</span><span class="sy0">;</span>
		<span class="br0">}</span>
		<span class="kw1">return</span> <span class="nu0">0</span><span class="sy0">;</span>
	<span class="br0">}</span>
&nbsp;
	<span class="kw1">public</span> MapHandler<span class="br0">(</span><span class="kw4">int</span> mapWidth, <span class="kw4">int</span> mapHeight, <span class="kw4">int</span><span class="br0">[</span>,<span class="br0">]</span> map, <span class="kw4">int</span> percentWalls<span class="sy0">=</span><span class="nu0">40</span><span class="br0">)</span>
	<span class="br0">{</span>
		<span class="kw1">this</span><span class="sy0">.</span><span class="me1">MapWidth</span> <span class="sy0">=</span> mapWidth<span class="sy0">;</span>
		<span class="kw1">this</span><span class="sy0">.</span><span class="me1">MapHeight</span> <span class="sy0">=</span> mapHeight<span class="sy0">;</span>
		<span class="kw1">this</span><span class="sy0">.</span><span class="me1">PercentAreWalls</span> <span class="sy0">=</span> percentWalls<span class="sy0">;</span>
		<span class="kw1">this</span><span class="sy0">.</span><span class="me1">Map</span> <span class="sy0">=</span> <span class="kw3">new</span> <span class="kw4">int</span><span class="br0">[</span><span class="kw1">this</span><span class="sy0">.</span><span class="me1">MapWidth</span>,<span class="kw1">this</span><span class="sy0">.</span><span class="me1">MapHeight</span><span class="br0">]</span><span class="sy0">;</span>
		<span class="kw1">this</span><span class="sy0">.</span><span class="me1">Map</span> <span class="sy0">=</span> map<span class="sy0">;</span>
	<span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
</div>
<h2> <span class="mw-headline" id="Implementations"> Implementations </span></h2>
<ul><li> <a href="http://www.roguebasin.com/index.php?title=C" title="C">C</a>: <a href="http://www.roguebasin.com/index.php?title=Brogue" title="Brogue">Brogue</a> source code
</li><li> <a href="http://www.roguebasin.com/index.php?title=C" title="C">C#</a>: <a rel="nofollow" class="external text" href="http://www.csharpprogramming.tips/2013/07/Rouge-like-dungeon-generation.html">csharpprogramming.tips</a>
</li><li> <a href="http://www.roguebasin.com/index.php?title=Javascript" title="Javascript" class="mw-redirect">Javascript</a>: <a href="http://www.roguebasin.com/index.php?title=Rot.js" title="Rot.js">rot.js</a>
</li><li> <a href="http://www.roguebasin.com/index.php?title=Lua" title="Lua">Lua</a>: <a href="http://www.roguebasin.com/index.php?title=RotLove" title="RotLove">RotLove</a>
</li><li> <a href="http://www.roguebasin.com/index.php?title=Python" title="Python">Python</a>: <a rel="nofollow" class="external text" href="http://pixelenvy.ca/wa/ca_cave.html">ca_cave</a>
</li></ul>

<!-- 
NewPP limit report
Preprocessor node count: 67/1000000
Postexpand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key 133099-basin:pcache:idhash:991-0!*!0!!en!*!* and timestamp 20190702113612 -->
</div><div class="printfooter">
Retrieved from "<a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels&amp;oldid=43208">http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels&amp;oldid=43208</a>"</div>
		<div id="catlinks" class="catlinks"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="http://www.roguebasin.com/index.php?title=Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="http://www.roguebasin.com/index.php?title=Category:Articles" title="Category:Articles">Articles</a></li><li><a href="http://www.roguebasin.com/index.php?title=Category:WorldGeneration" title="Category:WorldGeneration">WorldGeneration</a></li><li><a href="http://www.roguebasin.com/index.php?title=Category:Maps" title="Category:Maps">Maps</a></li></ul></div></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-main" class="selected"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels" primary="1" context="subject" title="View the content page [alt-shift-c]" accesskey="c">Page</a></li>
				<li id="ca-talk"><a href="http://www.roguebasin.com/index.php?title=Talk:Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels" primary="1" context="talk" title="Discussion about the content page [alt-shift-t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels&amp;action=edit" primary="1" title="This page is protected.
You can view its source [alt-shift-e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels&amp;action=history" rel="archives" title="Past revisions of this page [alt-shift-h]" accesskey="h">History</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="http://www.roguebasin.com/index.php?title=Special:UserLogin&amp;returnto=Cellular+Automata+Method+for+Generating+Random+Cave-Like+Levels" title="You are encouraged to log in; however, it is not mandatory [alt-shift-o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
<a href="http://www.roguebasin.com/index.php?title=Main_Page" style="background-image: url(/skins/roguebasin/RogueBasin_logo.png);" title="Visit the main page"></a>
	</div>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>Navigation</h5>
		<div class="pBody">
			<ul>
				<li id="n-mainpage"><a href="http://www.roguebasin.com/index.php?title=Main_Page" title="Visit the main page [alt-shift-z]" accesskey="z">Main Page</a></li>
				<li id="n-portal"><a href="http://www.roguebasin.com/index.php?title=RogueBasin:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-recentchanges"><a href="http://www.roguebasin.com/index.php?title=Special:RecentChanges" title="A list of recent changes in the wiki [alt-shift-r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="http://www.roguebasin.com/index.php?title=Special:Random" title="Load a random page [alt-shift-x]" accesskey="x">Random page</a></li>
				<li id="n-help"><a href="http://www.roguebasin.com/index.php?title=Help" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="http://www.roguebasin.com/index.php" id="searchform">
				<input type="hidden" name="title" value="Special:Search">
				<input type="search" name="search" title="Search RogueBasin [alt-shift-f]" accesskey="f" id="searchInput">
				<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton">&nbsp;
				<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton">
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Tools</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="http://www.roguebasin.com/index.php?title=Special:WhatLinksHere/Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels" title="A list of all wiki pages that link here [alt-shift-j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="http://www.roguebasin.com/index.php?title=Special:RecentChangesLinked/Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels" title="Recent changes in pages linked from this page [alt-shift-k]" accesskey="k">Related changes</a></li>
				<li id="t-specialpages"><a href="http://www.roguebasin.com/index.php?title=Special:SpecialPages" title="A list of all special pages [alt-shift-q]" accesskey="q">Special pages</a></li>
				<li><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels&amp;printable=yes" rel="alternate">Printable version</a></li>
				<li id="t-permalink"><a href="http://www.roguebasin.com/index.php?title=Cellular_Automata_Method_for_Generating_Random_Cave-Like_Levels&amp;oldid=43208" title="Permanent link to this revision of the page">Permanent link</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-poweredbyico">
		<a href="http://www.mediawiki.org/"><img src="./Cellular Automata Method for Generating Random Cave-Like Levels - RogueBasin_files/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31"></a>
	</div>
	<ul id="f-list">
		<li id="lastmod"> This page was last modified on 19 September 2016, at 04:23.</li>
		<li id="viewcount">This page has been accessed 329,693 times.</li>
		<li id="privacy"><a href="http://www.roguebasin.com/index.php?title=RogueBasin:Privacy_policy" title="RogueBasin:Privacy policy">Privacy policy</a></li>
		<li id="about"><a href="http://www.roguebasin.com/index.php?title=RogueBasin:About" title="RogueBasin:About">About RogueBasin</a></li>
		<li id="disclaimer"><a href="http://www.roguebasin.com/index.php?title=RogueBasin:General_disclaimer" title="RogueBasin:General disclaimer">Disclaimers</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
mw.loader.load(["mediawiki.user","mediawiki.page.ready"], null, true);
}</script><script src="./Cellular Automata Method for Generating Random Cave-Like Levels - RogueBasin_files/load(5).php" type="text/javascript"></script>
<script src="./Cellular Automata Method for Generating Random Cave-Like Levels - RogueBasin_files/load(6).php"></script>
<!-- Served in 0.202 secs. --></body></html>