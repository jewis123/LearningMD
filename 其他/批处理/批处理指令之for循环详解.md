### 基本格式

```
for /参数 %%变量 in (集) do 命令
```

- 参数种类

  FOR分四种参数 D L R F，并且有的参数还可附加另外的选项下面会分别介绍

- 变量

  在命令行中变量前是一个·%·，在批处理中才是两个·%·，且变量字符区分大小写。

- 集

  由系列文件、字符串或命令产生的内容形成的集合（可以使用通配符`*`,`?`,还可以使用环境变量）。for循环指令按一定顺序和规律分次读取集中内容，赋值给变量，并执行do后的命令，进行循环下一轮，直至集中内容读取完毕，而括号是格式必须的(in到后面括号之间要有空格)。

- 命令

  可以是任何合格的DOS命令或外部可被DOS调用的程序，且可采用括号把多条命令括起来，在一次循环中执行。

- 附注

  由于一些目录或文件名可能会有空格，所以很多时候集里和命令里往往需要用英文引号括起来(但有时引号里的内容可能会被认为是字符串)表示是一整体，下面开始的有些例中为简捷起见，忽略文件名或目录名带空格这种情况

**一、参数 /D： 遍历目录**
for /d %%变量 in (集) do 命令
/d 参数是指定仅对目录而不是文件执行的for命令。
例1:
在命令行输入（不是在批处理，之后不再解释）

```
for /d %%a in (c:\*.*) do @echo %a
```

运行会把C盘根目录下的全部目录分次显示出来,而不显示文件名

**二、参数 /R : 遍历路径做匹配**
`/r`参数之后还可带盘符及路径
在/r 之后的那个路径，指包含它之下的整个目录树（相当于DOS命令tree里的范围）中的所有目录，如果仅为一个英文句点 . ，是指当前路径下的目录树，如果省略了路径则特指当前目录，而之后的in (集)则相当于与前面每个目录相配的文件集
这里按in(集)中有无通配符分两种情况
1)  in(集)中没有通配符
指定的是单个文件或列举的具体文件(多个文件名之间用分隔符分隔，如空格、逗号等)
例2

```
@echo off
for /r . %%i in (abc.txt) do echo . > %%i
```

注：这里for /r 后的路径仅有一个 . 而后面每个循环中echo. > %i相当于创建一个仅有一空行的文本文件，整体效果是在当前目录下包括子录，每个目录中建一个abc.txt。
例3 （放入批处理中）

```
@echo off 
::显示d:盘中所有文件名为file1和file2的列表
for /r d:\ %%h in (file1,file2) do (
if exist %%h echo %%h
pause
)
```


2) in(集)中含有通配符`*`或`？`
这种里面的do命令将处理前面 /r指定的目录系列里每个含有in(集)中文件的项，而不去理会不含有相配文件的那些目录
例4：

```
@echo off
:: 删除C盘所有.chk结尾的文件
for /r C:\ %%h in (*.chk) do del /q %%h
```


注：del /q 表示用安静模式删除（不需确认）

**三、参数 /L: 生成迭代序列**

```
for /L %%变量 in (起始值，每次增值，结束时的比较值) do 命令
```

(起始值，每次增值，结束时的比较值)相当于一个等差数字序列，从“起始值”的数字开始，每次增加多少（也可设定为负数）为“每次增值”，并与“结束时的比较值”比较，超出则退出for循环（也不执行本轮后面的do 命令）
例如 (1,1,3) 将产生序列 （1 2 3）；（1,2,9）将产生序列（1 3 5 7 9）；(5,-1,1) 将产生序列 (5 4 3 2 1)；（1,3,18）将产生序列（1 7 10 13 16）
例5

```
@echo off
::在D盘建立aa1~ aa5五个文件夹
for /L %%i in (1,1,5) do (
md d:\aa %%i
pause)
```

**四、参数 /f: 按需分解每次迭代元素**
这个参数/f将会打开（集）里的文件，使for命令能处理文本文件的读取和添加删除替换等编辑性的操作，可谓功能强大，因此也相对复杂一些。

```
三种格式
1. FOR /F ["options"] %%变量 IN (file-set) DO 批处理指令
2. FOR /F ["options"] %%变量 IN ("string") DO 批处理指令
3. FOR /F ["options"] %%变量 IN ('command') DO 批处理指令
注：如果没有配置option,默认以空格分割每条记录
```

option种类：

- skip: 跳过头几行
- token：取分割段中的第几段
- delims：指定分割字符
- eol: 指定以什么字符开头的行为注释行，并且忽略此行

```
for /f "skip=1 eol=: tokens=1,2-4,* delims= " %%c in (d:\abc.txt) do (
    @echo %%c : %%d :%%e : %%f : %%g
)
说明：跳过第一行，默认忽略空行，或略冒号开头的注释行，以空格为分隔符，将文本每行分割成序列，第1段分给%%c,第2-4段依次分给%%d-f,剩下的分给%%g
```









